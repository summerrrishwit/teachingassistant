# 中文 Prompt 与思维链技术更新说明

## 📋 更新概述

### ✅ 已完成的更改

1. **注释英文 Prompt**
   - 所有英文 prompt 已注释保留
   - 便于未来参考和回退

2. **创建中文 Prompt**
   - 所有 prompt 已改为中文版本
   - 使用更符合中文表达习惯的措辞

3. **集成思维链（Chain-of-Thought, CoT）技术**
   - 每个 prompt 都包含明确的思维步骤
   - 引导模型进行逐步推理
   - 提高答案的逻辑性和准确性

## 🧠 思维链技术说明

### 什么是思维链（CoT）？

思维链是一种提示工程技术，通过引导模型展示其推理过程，从而提高复杂问题的解答质量。

### 思维链的优势

1. **提高准确性**：逐步推理减少错误
2. **增强可解释性**：展示思考过程
3. **改善逻辑性**：结构化思考过程
4. **提升深度**：鼓励深入分析

### 本项目中使用的思维链结构

每个 prompt 都包含以下思维链步骤：

#### 1. PROMPT_QA（视频问答）
- **第一步**：理解问题
- **第二步**：分析上下文
- **第三步**：提取相关信息
- **第四步**：整合信息
- **第五步**：组织答案
- **最终答案**：给出详细回答

#### 2. PROMPT_QA_RAG（RAG增强问答）
- **第一步**：理解问题
- **第二步**：分析检索到的相关片段
- **第三步**：整合全局上下文
- **第四步**：分析聚焦片段
- **第五步**：综合推理
- **第六步**：构建答案
- **最终答案**：给出结构化回答

#### 3. PROMPT_BULLET（要点提取）
- **第一步**：整体理解
- **第二步**：识别关键概念
- **第三步**：分析步骤和流程
- **第四步**：提取关键信息
- **第五步**：组织要点
- **最终输出**：生成要点列表

#### 4. PROMPT_QA_STYLE（问答对生成）
- **第一步**：理解视频内容
- **第二步**：识别学习要点
- **第三步**：设计问题
- **第四步**：构建答案
- **第五步**：组织问答对
- **最终输出**：生成问答对

#### 5. PROMPT_VIDEO_SUMMARY（视频总结）
- **第一步**：整体理解
- **第二步**：内容分析
- **第三步**：结构分析
- **第四步**：价值评估
- **第五步**：受众分析
- **第六步**：学习目标
- **最终输出**：生成结构化总结

## 📝 Prompt 对比

### 英文版本（已注释）
```python
# PROMPT_QA = """You are a helpful teaching assistant...
# Question: {question}
# Answer:"""
```

### 中文版本（带思维链）
```python
PROMPT_QA = """你是一位专业的教学助手...
请按照以下思维链步骤进行思考：

**第一步：理解问题**
- 仔细阅读用户的问题：{question}
...

**最终答案：**
基于以上分析，请给出详细且准确的回答："""
```

## 🎯 思维链技术的关键要素

### 1. 明确的步骤划分
- 每个步骤都有清晰的标题
- 步骤之间有逻辑递进关系

### 2. 具体的指导指令
- 每个步骤都包含具体的操作指导
- 明确告诉模型需要做什么

### 3. 结构化的输出要求
- 明确最终输出的格式
- 确保输出的一致性和可读性

### 4. 上下文整合
- 引导模型整合多个信息源
- 建立信息之间的关联

## 💡 使用建议

### 1. 根据任务调整思维链
不同任务可能需要不同的思维步骤，可以根据实际需求调整。

### 2. 平衡详细程度
- 过于详细的思维链可能增加 token 消耗
- 过于简略可能无法发挥 CoT 的优势
- 建议根据任务复杂度调整

### 3. 结合 vLLM 优化
- vLLM 支持长序列，可以充分利用思维链
- Flash Attention 确保长 prompt 的高效处理
- 建议 `max_model_len` 设置为 8192 或更高

## 📊 预期效果

### 改进前（英文 Prompt，无思维链）
- 答案可能不够深入
- 推理过程不透明
- 逻辑性可能不足

### 改进后（中文 Prompt，带思维链）
- ✅ 答案更加详细和准确
- ✅ 推理过程清晰可见
- ✅ 逻辑结构更加完善
- ✅ 更符合中文表达习惯

## 🔄 回退到英文版本

如果需要回退到英文版本：

1. 在 `app/config.py` 中取消注释英文 prompt
2. 注释掉中文 prompt
3. 重新运行应用

## 📚 参考资源

- [Chain-of-Thought Prompting](https://arxiv.org/abs/2201.11903)
- [思维链提示工程最佳实践](https://www.promptingguide.ai/techniques/cot)
- [中文 Prompt 工程指南](https://github.com/Prompt-Engineering-Guide/Prompt-Engineering-Guide)

---

*最后更新: 2025-12-14*

